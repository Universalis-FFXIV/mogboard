{% extends 'Admin/base.html.twig' %}

{% block body %}

    <h2>Real-time Statistics</h2>

    <div>
        <button id="reset">Reset</button>
    </div>

    <br><br>

    <p>
        <strong>Test: <span id="mb_TEST"></span></strong>
    </p>

    <p>
        <strong>STARTDATE: <span id="mb_STARTDATE"></span></strong>
    </p>

    <ul>
        <li>TOTAL_ALERTS = <span id="mb_TOTAL_ALERTS"></span></li>
        <li>TOTAL_ALERTS_DPS = <span id="mb_TOTAL_ALERTS_DPS"></span></li>
        <li>TOTAL_ALERTS_TRIGGERED = <span id="mb_TOTAL_ALERTS_TRIGGERED"></span></li>
        <li>TOTAL_MANUAL_UPDATES = <span id="mb_TOTAL_MANUAL_UPDATES"></span></li>
        <li>TOTAL_MANUAL_UPDATES_FORCE = <span id="mb_TOTAL_MANUAL_UPDATES_FORCE"></span></li>
        <li>ITEM_UPDATED = <span id="mb_ITEM_UPDATED"></span></li>
        <li>PAGE_VIEW = <span id="mb_PAGE_VIEW"></span></li>
    </ul>

    <script>
    function getStatistics() {
        $.get('/admin/tracking_stats', response => {
            for(let constant in response) {
                let value = response[constant];
                $('#mb_' + constant).html(value);
            }
        });
    }

    $('#reset').on('click', event => {
        $.get('/admin/tracking_stats_reset');
    });

    setInterval(function() {
        getStatistics()
    }, 1000);
    </script>

{% endblock %}
